{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<!-- Hero Section with Gradient Background -->
<div class="hero-section mb-5 reveal">
    <div class="parallax-layer"></div>
    <div class="container text-center py-5">
        <h1 class="hero-title mb-4">
            Welcome to JobSentinel
        </h1>
        <p class="hero-subtitle mb-4">
            Your AI-Powered Job Search Assistant
        </p>
        <p class="lead text-muted">
            Automate your job search with intelligent matching and insights
        </p>
    </div>
</div>

<div class="row">
    <div class="col-lg-8 col-md-7">
        <div class="card reveal reveal-stagger-1 gpu-accelerated">
            <div class="card-header">
                <h4>‚öôÔ∏è Configuration</h4>
            </div>
            <div class="card-body">
                <!-- nosemgrep: python.django.security.django-no-csrf-token.django-no-csrf-token -->
                <form action="{{ url_for('main.save_config') }}" method="post">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <div class="mb-3">
                        <label for="config" class="form-label">User Preferences (JSON)</label>
                        <textarea id="config" name="config" class="form-control" rows="25" aria-describedby="configHelp">{{ prefs | tojson(indent=2) }}</textarea>
                        <div id="configHelp" class="form-text">Edit your configuration settings in JSON format. Changes take effect after saving.</div>
                    </div>
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">üíæ Save Configuration</button>
                        <a href="{{ url_for('main.logs') }}" class="btn btn-secondary">üìã View Logs</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-4 col-md-5">
        <div class="card reveal reveal-stagger-2 gpu-accelerated">
            <div class="card-header">
                <h4>üìä Database Stats</h4>
            </div>
            <div class="card-body">
                <div class="stat-card mb-3">
                    <div class="stat-value">{{ stats.total_jobs or 0 }}</div>
                    <div class="stat-label">Total Jobs</div>
                </div>
                <div class="stat-card mb-3">
                    <div class="stat-value">{{ stats.recent_jobs_24h or 0 }}</div>
                    <div class="stat-label">New in 24 Hours</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{ stats.high_score_jobs or 0 }}</div>
                    <div class="stat-label">High-Score Jobs</div>
                </div>
            </div>
        </div>
        
        <div class="card reveal reveal-stagger-3 gpu-accelerated">
            <div class="card-header">
                <h4>üéØ Recent Jobs</h4>
            </div>
            <ul class="list-group list-group-flush">
                {% for job in jobs %}
                <li class="list-group-item">
                    <!-- nosemgrep: generic.html-templates.security.var-in-href.var-in-href -->
                    <a href="{{ job.url | safe_external_url }}" target="_blank" rel="noopener noreferrer" class="job-title">
                        {{ job.title | e }}
                    </a>
                    <div class="d-flex justify-content-between align-items-center mt-2">
                        <small class="text-muted">{{ job.company | e }}</small>
                        <span class="job-score">{{ "%.1f"|format(job.score) }}</span>
                    </div>
                </li>
                {% else %}
                <li class="list-group-item">
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div class="empty-state-title">No Jobs Yet</div>
                        <div class="empty-state-text">Jobs will appear here once the scraper finds matches.</div>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endblock %}
