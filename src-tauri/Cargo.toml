[package]
name = "jobsentinel"
version = "2.6.3"
description = "Privacy-first job search automation for Windows 11+"
authors = ["Chad Boyd"]
license = "MIT"
repository = "https://github.com/cboyd0319/JobSentinel"
keywords = ["job-search", "automation", "privacy", "tauri", "desktop-app"]
categories = ["command-line-utilities"]
edition = "2021"

[features]
default = []
# OCR support for scanned PDFs (uses command-line tesseract + pdftoppm)
# Requires: tesseract-ocr and poppler-utils installed on system
ocr = []

[build-dependencies]
tauri-build = { version = "2", features = [] }

[dependencies]
# Tauri Core
tauri = { version = "2", features = ["tray-icon"] }
tauri-plugin-shell = "2"
tauri-plugin-notification = "2"
tauri-plugin-dialog = "2"
tauri-plugin-secure-storage = "1.4"

# Direct keyring access for Rust backend (same crate used by plugin)
keyring = { version = "3", features = ["apple-native", "windows-native", "sync-secret-service"] }

# Serialization
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# Async Runtime
tokio = { version = "1.42", features = ["full"] }
async-trait = "0.1"

# HTTP Client
reqwest = { version = "0.12", features = ["json", "rustls-tls"] }
url = "2.5"

# HTML Parsing
scraper = "0.21"

# URL encoding for query parameters
urlencoding = "2.1"

# Regular expressions for pattern matching
regex = "1.10"

# Database
sqlx = { version = "0.8", default-features = false, features = ["runtime-tokio-rustls", "sqlite", "migrate", "chrono", "macros"] }

# Date/Time
chrono = { version = "0.4", features = ["serde"] }

# Configuration
dotenvy = "0.15"

# Error Handling
thiserror = "2.0"
anyhow = "1.0"

# UUIDs
uuid = { version = "1.11", features = ["v4"] }

# Logging
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }

# SHA-256 for job hashing
sha2 = "0.10"
hex = "0.4"

# Lazy initialization for shared resources
once_cell = "1.19"

# Scope guard for cleanup
scopeguard = "1.2"

# Platform directories
dirs = "5.0"

# Email notifications (SMTP)
lettre = { version = "0.11", default-features = false, features = ["tokio1-rustls-tls", "builder", "smtp-transport"] }

# PDF parsing for resume extraction
pdf-extract = "0.7"
docx-rs = "0.4"

# Note: OCR feature uses command-line tesseract and pdftoppm (no Rust crate dependencies)
# This avoids complex native library linking while still providing OCR support

# Browser automation for form filling (One-Click Apply)
chromiumoxide = { version = "0.7", default-features = false, features = ["tokio-runtime"] }
futures-util = "0.3"

[target.'cfg(windows)'.dependencies]
windows = { version = "0.58", features = ["Win32_Foundation", "Win32_System_Threading"] }

[target.'cfg(target_os = "macos")'.dependencies]
# Native macOS cookie extraction from WKWebView
objc2 = "0.5"
objc2-foundation = { version = "0.2", features = ["NSString", "NSArray", "NSDictionary", "NSDate", "NSURL", "block2"] }
objc2-web-kit = { version = "0.2", features = ["WKWebsiteDataStore", "WKHTTPCookieStore", "WKWebViewConfiguration", "WKWebView", "block2"] }
block2 = "0.5"

[dev-dependencies]
tempfile = "3.13"
proptest = "1.5"
wiremock = "0.6"
futures = "0.3"

# Release profile with security hardening
[profile.release]
# Enable link-time optimization for smaller, faster binaries
lto = "thin"
# Strip debug symbols to reduce binary size and prevent reverse engineering
strip = "symbols"
# Single codegen unit for better optimization (at cost of compile time)
codegen-units = 1
# Abort on panic instead of unwinding (smaller binary, prevents info leaks)
panic = "abort"
# Enable overflow checks even in release builds
overflow-checks = true

[lints.rust]
unsafe_code = "deny"

[lints.clippy]
pedantic = { level = "warn", priority = -1 }
nursery = { level = "warn", priority = -1 }
# Allow expect/unwrap in tests via #[cfg(test)] allow attributes
# These are denied in production code
unwrap_used = "warn"
expect_used = "warn"
# Allow from_str methods that don't impl FromStr (used for infallible parsing)
should_implement_trait = "allow"
# Allow pub(crate) in private modules (intentional API design)
redundant_pub_crate = "allow"
# Allow matches! alternatives (stylistic choice)
match_like_matches_macro = "allow"
equatable_if_let = "allow"
# Allow single-char string patterns (readability)
single_char_pattern = "allow"
# Allow wildcard imports for prelude-style modules
wildcard_imports = "allow"
# Allow manual derive impls (sometimes needed for custom logic)
derivable_impls = "allow"
# Allow push_str with single char (readability over micro-optimization)
single_char_add_str = "allow"
# Allow format! for consistency
useless_format = "allow"
# Allow redundant field names (explicit is clearer)
redundant_field_names = "allow"
# Allow unwrap_or_else for defaults (stylistic)
unwrap_or_default = "allow"
# Allow manual char comparisons
manual_is_ascii_check = "allow"
# Allow consecutive replace calls
collapsible_str_replace = "allow"
# Allow &PathBuf (sometimes needed for API compatibility)
ptr_arg = "allow"
# Allow suboptimal mul_add (clarity over micro-optimization)
suboptimal_flops = "allow"
# Allow manual char range patterns (clearer intent)
manual_range_patterns = "allow"
# Doc link format flexibility
doc_link_with_quotes = "allow"
# Allow clamp-like patterns (sometimes clearer)
manual_clamp = "allow"
# Allow iteration style choices
explicit_iter_loop = "allow"
# Allow empty string construction style
default_trait_access = "allow"
manual_string_new = "allow"
# Allow collection usage patterns
collection_is_never_read = "allow"
# Allow char comparisons
manual_pattern_char_comparison = "allow"
# Allow debug formatting in errors
unnecessary_debug_formatting = "allow"
# Allow unnecessary casts (for clarity)
unnecessary_cast = "allow"
